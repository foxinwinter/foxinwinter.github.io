<!DOCTYPE html>
<html lang="en">
<head>
<link rel="icon" type="image/png" href="favicon.png">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Project: Terminal</title>
<link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
<style>
html, body { margin:0; padding:0; height:100%; font-family:'VT323',monospace; background:#000; overflow:hidden; }
#terminal-wrapper { width:100%; height:100%; display:flex; justify-content:center; align-items:center; position:relative; }
#terminal {
  display:flex; flex-direction:column; justify-content:flex-end;
  height:95%; width:95%; padding:20px; box-sizing:border-box;
  color:#0f0; text-shadow:0 0 1px #0f0, 0 0 2px #0f0;
  border-radius:2% / 5%;
  transform:perspective(1000px) rotateX(1deg) scale(1.05,1);
  filter:contrast(1.2) brightness(1.1);
  position:relative;
}
#terminal::before {
  content:""; position:absolute; top:0; left:0; width:100%; height:100%; pointer-events:none;
  background: repeating-linear-gradient(to bottom, rgba(0,0,0,0) 0px, rgba(0,0,0,0.08) 1px, rgba(0,0,0,0) 2px);
  z-index:10;
}
@keyframes flicker { 0%,100% {opacity:1;} 25% {opacity:0.95;} 50% {opacity:0.9;} 75% {opacity:0.97;} }
#terminal { animation:flicker 0.15s infinite; }
#line-container { flex:1; overflow-y:auto; font-size:1.5em; margin-bottom:10px; }
.line { white-space:pre-wrap; margin-bottom:5px; display:block; overflow:hidden; }
#input-line { display:flex; align-items:center; }
#prompt { margin-right:5px; }
#command { flex:1; background:transparent; border:none; outline:none; color:#0f0; font-family:'VT323',monospace; font-size:1.5em; caret-color:#0f0; text-shadow:0 0 1px #0f0,0 0 2px #0f0; }
a { color:#00ffff; text-decoration:underline; }
.scanline { position:absolute; top:0; left:-100%; width:100%; height:2px; background:rgba(0,255,0,0.15); animation:scanline 0.8s linear infinite; pointer-events:none; z-index:20; }
@keyframes scanline { 0% { left:-100%; } 100% { left:100%; } }
</style>
</head>
<body>
<div id="terminal-wrapper">
  <div id="terminal">
    <div id="line-container"></div>
    <div class="scanline"></div>
    <div id="input-line"><span id="prompt">></span><input id="command" autocomplete="off" autofocus /></div>
  </div>
</div>
<script>
const output=document.getElementById('line-container');
const commandInput=document.getElementById('command');
const promptEl=document.getElementById('prompt');
const startTime=Date.now();
let inSubmenu=false, submenuType="", lastProjectSelected=null;
let inputBlocked=false;

// Socials & Projects
const SOCIALS={
  Main: { GitHub:'<a href="https://github.com/foxinwinter" target="_blank">foxinwinter</a>', Discord:"foxinwinter" },
  Games: {
    Steam:'<a href="https://steamcommunity.com/profiles/76561199787346897/" target="_blank">foxinwinter</a>',
    Epic:'<a href="https://www.epicgames.com/id/foxinwinter" target="_blank">foxinwinter</a>',
    Playstation:"Arandomfrog2344",
    Roblox:'<a href="https://www.roblox.com/users/2659637559/profile" target="_blank">Jaxon28784</a>'
  }
};
const PROJECTS=[
  {name:"My Website", description:"Terminal-style website with commands", link:"https://github.com/foxinwinter/TUI-Style_Website"},
  {name:"Word Synced Lyircs for any song playing from a MPRIS Music Player viewable on a Website", description:"Work In Progress way to see Word-Synced Lyrics of any song playing on my Laptop on my Website", link:"None"},
  {name:"Custom RPC", description:"A program I'm working on to use custom RPC, working on CLI commands", link:"https://github.com/foxinwinter/Custom-RPC"},
  {name:"confs.sh", description:"Abandoned: I have ditched this project and moved to a more personal installer (WILL NOT BE PUBLIC, probably)", link:"https://github.com/foxinwinter/confs.sh"}
];

// Commands & Descriptions
const COMMANDS=['updates', 'help','clear','about','socials','projects','date','theme','fortune','hack','cat','dog','scan','uptime','weather','trace'];
const COMMAND_DESCRIPTIONS={
  updates:"Updates about Projects I'm working on",
  help:"Show available commands",
  clear:"Clear all user input/output but keep headers",
  date:"Display my local time",
  theme:"Change terminal theme (green/amber/white). Usage: theme green",
  fortune:"Print a random fortune",
  hack:"Fake hacking animation",
  projects:"List my projects",
  about:"About this terminal",
  socials:"My socials",
  cat:"Random cat ASCII or link",
  dog:"Random dog ASCII or link",
  scan:"Fake network scan",
  uptime:"Time since terminal loaded",
  weather:"My Local Weather",
  trace:"Simulate a traceroute"
};

// CRT Typing
let printQueue=Promise.resolve();
function typeLineCRT(text,speed=10){
  return new Promise(resolve=>{
    inputBlocked=true;
    commandInput.disabled=true;
    const line=document.createElement('div');
    line.className='line';
    output.appendChild(line);
    output.scrollTop=output.scrollHeight;
    let i=0;
    const interval=setInterval(()=>{
      if(i<=text.length){
        line.innerHTML=text.slice(0,i);
        output.scrollTop=output.scrollHeight;
        i++;
      }else{ clearInterval(interval); inputBlocked=false; commandInput.disabled=false; commandInput.focus(); resolve(line); }
    },speed);
  });
}
function printLineQueued(text,speed=10){ printQueue=printQueue.then(()=>typeLineCRT(text,speed)); return printQueue; }

// Focus input
document.body.addEventListener('click',()=>commandInput.focus());
commandInput.addEventListener('blur',()=>setTimeout(()=>commandInput.focus(),0));
commandInput.focus();

// Main screen
function showMainScreen(){
  output.innerHTML='';
  printLineQueued('Welcome to my website, enjoy your stay!');
  printLineQueued('Type "help" to see available commands.');
}
showMainScreen();

// Command handler
commandInput.addEventListener('keydown', async(e)=>{
  if(e.key!=='Enter' || inputBlocked) return;
  const raw=commandInput.value.trim(); if(!raw) return;
  const parts=raw.split(' ');
  const cmd=parts[0].toLowerCase();
  commandInput.value='';

  // --- Submenu logic ---
  if(inSubmenu){
    if(submenuType==='socials'){
      if(cmd==='back'){ inSubmenu=false; submenuType=""; showMainScreen(); }
      else printLineQueued(`Unknown command in socials submenu: ${cmd}`);
      return;
    }
    if(submenuType==='projects'){
      if(cmd==='back'){ inSubmenu=false; submenuType=""; lastProjectSelected=null; showMainScreen(); return; }
      const num=parseInt(cmd);
      if(num>=1 && num<=PROJECTS.length){
        lastProjectSelected=num-1;
        const p=PROJECTS[lastProjectSelected];

        // Remove previous project details (keep menu)
        const lines=output.querySelectorAll('.line');
        lines.forEach((line,index)=>{
          if(index>PROJECTS.length) line.remove();
        });

        // Print selected project details
        printLineQueued(`\n${p.name}: ${p.description}`);
        printLineQueued(`Link: <a href="${p.link}" target="_blank">${p.link}</a>`);
        printLineQueued('Type "back" to return.');
      } else {
        printLineQueued(`Invalid project number: ${cmd}`);
      }
      return;
    }
  }

  if(!(cmd==='projects' || cmd==='socials')) printLineQueued('> '+raw);

  switch(cmd){
    case 'updates':
       printLineQueued("Fetching updates...").then(async () => {
       try {
       const res = await fetch('updates.txt'); // relative path works if in root
         if(!res.ok) throw new Error("Failed to fetch");
          const text = await res.text();
           // Split by line and print each line
           const lines = text.split('\n');
           for(const line of lines){
           await printLineQueued(line);
          }
    } catch(e){
      printLineQueued("Failed to load updates.");
    }
  });
  break;


      
    case 'help':
      printLineQueued("COMMAND        DESCRIPTION");
      for(const c of COMMANDS){
        const pad=' '.repeat(14-c.length);
        printLineQueued(`${c}${pad}${COMMAND_DESCRIPTIONS[c]}`);
      }
      break;

    case 'clear':
      if(!inSubmenu){
        const lines=output.querySelectorAll('.line');
        lines.forEach((line,index)=>{ if(index>=2) line.remove(); });
      }
      break;

    case 'date':
      printLineQueued(new Date().toLocaleString('en-US',{timeZone:'America/Chicago', weekday:'long', year:'numeric', month:'long', day:'numeric', hour:'numeric', minute:'numeric', second:'numeric'}));
      break;

    case 'uptime':
      const diff=Date.now()-startTime;
      const seconds=Math.floor(diff/1000), mins=Math.floor(seconds/60), hrs=Math.floor(mins/60);
      printLineQueued(`${hrs}h ${mins%60}m ${seconds%60}s`);
      break;

    case 'fortune':
      const fortunes=["You will code something amazing today.","Beware the semicolons!","A bug will appear in your code tomorrow.","Keep pushing forward!"];
      printLineQueued(fortunes[Math.floor(Math.random()*fortunes.length)]);
      break;

    case 'hack':
      for(let i=0;i<5;i++){ printLineQueued(`Hacking server ${Math.floor(Math.random()*1000)}...`); }
      break;

    case 'socials':
      inSubmenu=true; submenuType='socials';
      output.innerHTML='';
      printLineQueued("My Socials:");
      const allSocials = {...SOCIALS.Main, ...SOCIALS.Games};
      for(const [name, link] of Object.entries(allSocials)){
        printLineQueued(`${name}: ${link}`);
      }
      printLineQueued('Type "back" to return.');
      break;

    case 'projects':
      inSubmenu=true; submenuType='projects';
      lastProjectSelected=null;
      output.innerHTML='';
      printLineQueued("Projects:");
      PROJECTS.forEach((p,i)=>printLineQueued(`${i+1}: ${p.name}`));
      printLineQueued('Type project number to view details or "back" to return.');
      break;

    case 'cat': printLineQueued(["=^.^=","(=^-ω-^=)","https://cataas.com/cat"][Math.floor(Math.random()*3)]); break;
    case 'dog': printLineQueued(["U・ᴥ・U","∪･ω･∪","https://random.dog/woof.jpg"][Math.floor(Math.random()*3)]); break;

    case 'scan': for(let i=0;i<5;i++) printLineQueued(`Scanning 192.168.${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}...`); break;
    case 'trace': for(let i=0;i<5;i++) printLineQueued(`Trace hop ${i+1}: 10.0.${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}`); break;

    case 'weather':
      inputBlocked=true;
      commandInput.disabled=true;
      printLineQueued("Getting Weather...").then(async()=>{
        try{
          const res=await fetch('https://wttr.in/Minneapolis?format=3');
          const txt=await res.text();
          printLineQueued(txt);
        } catch(e){
          printLineQueued("Failed to fetch weather.");
        } finally{
          inputBlocked=false;
          commandInput.disabled=false;
          commandInput.focus();
        }
      });
      break;

    case 'about':
      printLineQueued("Hello! Welcome to my Website!");
      printLineQueued("You can use commands to explore my current/ past projects, find my socials and more!");
      break;

    case 'theme':
      const theme=parts[1]?.toLowerCase();
      let color="";
      if(theme==='green') color="#0f0";
      else if(theme==='amber') color="#ffb000";
      else if(theme==='white') color="#fff";
      else { printLineQueued("Usage: theme green|amber|white"); break; }

      document.querySelector('#terminal').style.color=color;
      commandInput.style.color=color;
      promptEl.style.color=color;
      break;

    default: printLineQueued(`Unknown command: ${cmd}`);
  }
});
</script>
</body>
</html>
